# Mercor Mini-Interview Task: Airtable Tooling System

## ‚úÖ Overview

This project involves building an **Airtable-based data model** and automation system that:

* Collects multi-part contractor applications
* Compresses and decompresses structured applicant data via Python scripts
* Applies shortlisting logic
* Uses an LLM to enrich and evaluate candidate profiles

---

## üì¶ Airtable Schema

### 1. **Applicants** (Parent Table)

| Field Name       | Type             | Description                                   |
| ---------------- | ---------------- | --------------------------------------------- |
| Applicant ID     | Single line text | Primary field ‚Äì unique identifier             |
| Compressed JSON  | Long text        | Nested JSON of all linked applicant data      |
| Shortlist Status | Single select    | Options: `Pending`, `Shortlisted`, `Rejected` |
| LLM Summary      | Long text        | Summary generated by the LLM                  |
| LLM Score        | Number (1‚Äì10)    | Candidate quality score                       |
| LLM Follow-Ups   | Long text        | Suggested follow-up questions from the LLM    |

### 2. **Personal Details** (1:1 Child)

| Field Name | Type                          |
| ---------- | ----------------------------- |
| Full Name  | Single line text              |
| Email      | Email                         |
| Location   | Single line text              |
| LinkedIn   | URL                           |
| Applicant  | Link to Applicants (required) |

### 3. **Work Experience** (1\:N Child)

| Field Name   | Type                                |
| ------------ | ----------------------------------- |
| Company      | Single line text                    |
| Title        | Single line text                    |
| Start        | Date                                |
| End          | Date                                |
| Technologies | Long text                           |
| Applicant    | Link to Applicants (allow multiple) |

### 4. **Salary Preferences** (1:1 Child)

| Field Name     | Type                          |
| -------------- | ----------------------------- |
| Preferred Rate | Number                        |
| Minimum Rate   | Number                        |
| Currency       | Single select                 |
| Availability   | Number (hrs/wk)               |
| Applicant      | Link to Applicants (required) |

### 5. **Shortlisted Leads** (Auto-generated)

| Field Name      | Type               |
| --------------- | ------------------ |
| Applicant       | Link to Applicants |
| Compressed JSON | Long text          |
| Score Reason    | Long text          |
| Created At      | Created time       |

---

## üßæ Form Flow

Since Airtable doesn‚Äôt support multi-table forms, we simulate it using three forms:

### 1. **Personal Details Form**

* Form collects applicant name, email, location, LinkedIn
* Generates new `Applicant` record

### 2. **Work Experience Form**

* Prefills `Applicant` using `RECORD_ID()` from first form
* URL format:

  ```
  ```

[https://airtable.com/form\_id?prefill\_Applicant=recXXXXXXXXX](https://airtable.com/form_id?prefill_Applicant=recXXXXXXXXX)

````

### 3. **Salary Preferences Form**
- Same prefill technique as Work Experience

---

## üß† JSON Compression Script (`compress_json.py`)

### Description:
- Fetches child-table data (Personal, Experience, Salary)
- Builds nested JSON per applicant
- Writes JSON to `Compressed JSON` field in `Applicants`

### Sample JSON Output:
```json
{
"personal": {"name": "Jane Doe", "location": "NYC"},
"experience": [
  {"company": "Google", "title": "SWE"},
  {"company": "Meta", "title": "Engineer"}
],
"salary": {"rate": 100, "currency": "USD", "availability": 25}
}
````

---

## üîÑ JSON Decompression Script (`decompress_json.py`)

### Description:

* Parses compressed JSON from `Applicants`
* Clears and upserts records to:

  * `Personal Details`
  * `Work Experience`
  * `Salary Preferences`
* Links each record to `Applicant`

---

## üèÜ Shortlist Automation Script (`shortlist_leads.py`)

### Rules:

* ‚úÖ Experience: ‚â• 4 years OR Tier-1 company (Google, Meta, etc.)
* ‚úÖ Compensation: ‚â§ 100 USD/hour AND ‚â• 20 hrs/week
* ‚úÖ Location: US, Canada, UK, Germany, or India

### Action:

If all criteria pass:

* Add record to `Shortlisted Leads`
* Copy `Compressed JSON`
* Write a readable `Score Reason`
* Update `Shortlist Status` to `Shortlisted`

---

## ü§ñ LLM Evaluation Script (`llm_review.py`)

### Trigger:

* Runs after `Compressed JSON` is added or updated

### Prompt:

```
You are a recruiting analyst. Given this applicant JSON, do four things:
1. Provide a concise 75-word summary.
2. Rate overall candidate quality from 1‚Äì10.
3. List any data gaps or inconsistencies.
4. Suggest up to three follow-up questions.

Return exactly:
Summary: <text>
Score: <integer>
Issues: <comma-separated list or 'None'>
Follow-Ups: <bullet list>
```

### Output Fields:

* `LLM Summary` (e.g. "SWE with 5 yrs at Google + Meta")
* `LLM Score` (1‚Äì10)
* `LLM Follow-Ups` (bulleted list)

### Validation:

* API key read from `.env`
* Exponential backoff on failure (3x max)
* No repeat calls if `LLM Summary` already exists

---

## üîê Authentication & Secrets

All keys are read via environment variables from `.env`:

```env
AIRTABLE_API_KEY=xxx
BASE_ID=appXXXXXX
OPENAI_API_KEY=sk-xxx
```

---

## üîß Customizing Criteria

To adjust shortlisting logic:

* Edit `TIER1_COMPANIES` or `VALID_LOCATIONS` in `shortlist_leads.py`
* Modify experience or compensation thresholds as needed

To adjust LLM behavior:

* Tweak prompt in `build_prompt()`
* Swap `openai.ChatCompletion` with another LLM provider

---
